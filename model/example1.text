# rag_utils.py
import openai

openai.api_key = "YOUR_OPENAI_API_KEY"

def generate_report(query: str, retrieved_context: str = "") -> str:
    system_prompt = (
        "You are a financial analyst assistant. Based on the user's query and context, generate a detailed financial report. "
        "Include data breakdowns, summaries, and mention charts if asked. If graph types are specified (e.g., pie, bar, line), describe them clearly."
    )

    messages = [
        {"role": "system", "content": system_prompt},
        {"role": "user", "content": f"Query: {query}\n\nContext: {retrieved_context}"}
    ]

    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo-16k",
        messages=messages,
        temperature=0.7,
        max_tokens=16000
    )
    return response.choices[0].message["content"]
